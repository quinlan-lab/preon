##SnpSiftVersion="SnpSift 4.3t (build 2017-11-24 10:18), by Pablo Cingolani"
##SnpSiftCmd="SnpSift Filter '(QUAL >= 20) & (GEN[ALL].DP >= 15)'"
##FILTER=<ID=SnpSift,Description="SnpSift 4.3t (build 2017-11-24 10:18), by Pablo Cingolani, Expression used: (QUAL >= 20) & (GEN[ALL].DP >= 15)">
##SnpEffVersion="4.3t (build 2017-11-24 10:18), by Pablo Cingolani"
##SnpEffCmd="SnpEff  -i vcf -o vcf -noStats GRCh38.86 biallelic.vcf.gz "
##INFO=<ID=ANN,Number=.,Type=String,Description="Functional annotations: 'Allele | Annotation | Annotation_Impact | Gene_Name | Gene_ID | Feature_Type | Feature_ID | Transcript_BioType | Rank | HGVS.c | HGVS.p | cDNA.pos / cDNA.length | CDS.pos / CDS.length | AA.pos / AA.length | Distance | ERRORS / WARNINGS / INFO' ">
##INFO=<ID=LOF,Number=.,Type=String,Description="Predicted loss of function effects for this variant. Format: 'Gene_Name | Gene_ID | Number_of_transcripts_in_gene | Percent_of_transcripts_affected'">
##INFO=<ID=NMD,Number=.,Type=String,Description="Predicted nonsense mediated decay effects for this variant. Format: 'Gene_Name | Gene_ID | Number_of_transcripts_in_gene | Percent_of_transcripts_affected'">

/scratch/ucgd/lustre-work/marth/projects/2019-welm-tow19/analysis/3.somatic-snv/Makefile


singularity exec docker://brwnj/preon:v0.0.4 bedtools intersect -a tow19.vcf.gz -b /scratch/ucgd/lustre-work/marth/u0991678/shared/res/20160622_grch38_pilot_mask.bed.gz -wa -u -header > masked.vcf
singularity exec docker://brwnj/preon:v0.0.4 SnpSift filter "(QUAL >= 20) & (GEN[ALL].DP >= 15)" masked.vcf > filtered.vcf
singularity exec docker://brwnj/preon:v0.0.4 bcftools view --min-alleles 2 --max-alleles 2 --output-file biallelic.vcf filtered.vcf
singularity exec docker://brwnj/preon:v0.0.4 snpEff -Xmx16g -i vcf -o vcf -noStats GRCh38.86 biallelic.vcf > snpeff.vcf

# start here in ~/work/preon/results-precision/freebayes
singularity exec docker://brwnj/preon:v0.0.4 SnpSift filter "(GEN[0].AO<=2)" snpeff.vcf | bgzip > somatic.vcf.gz
singularity exec docker://brwnj/preon:v0.0.4 tabix -p vcf somatic.vcf.gz
